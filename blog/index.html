---
layout: default
title: Blog
---

<h1 class="text-4xl font-extrabold text-green-800 mb-10 text-center">From the Blog</h1>

<!-- Search Input -->
<div class="mb-8 px-4 max-w-3xl mx-auto">
  <input
    type="text"
    id="search-input"
    placeholder="Search the blog…"
    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring focus:border-green-500"
  />
</div>

<!-- Search Results (hidden by default) -->
<ul id="search-results" class="hidden space-y-6 px-4 max-w-3xl mx-auto"></ul>

<!-- Pagination Controls (hidden by default) -->
<div id="pagination-controls" class="hidden flex justify-center mt-4 space-x-2 px-4 max-w-3xl mx-auto"></div>

<!-- All Posts (shown by default) -->
<div id="all-posts" class="space-y-12 px-4 max-w-3xl mx-auto">
  {% for post in site.posts %}
    <article>
      <h2 class="text-2xl font-bold mb-2 text-green-700">
        <a href="{{ post.url }}" class="hover:underline">{{ post.title }}</a>
      </h2>
      <p class="text-gray-700 mb-2">{{ post.description }}</p>
      <a href="{{ post.url }}" class="text-green-600 hover:underline">Read more →</a>
    </article>
  {% endfor %}
</div>

<!-- Mark.js for highlighting matches -->
<script src="https://cdn.jsdelivr.net/npm/mark.js/dist/mark.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput        = document.getElementById('search-input');
  const resultsContainer   = document.getElementById('search-results');
  const allPostsContainer  = document.getElementById('all-posts');
  const paginationContainer= document.getElementById('pagination-controls');

  const pageSize = 5;
  let currentPage = 0;
  let index = [];   // will hold our search.json data
  let results = [];

  // 1) Load the JSON index once
  fetch('{{ "/search.json" | relative_url }}')
    .then(res => res.json())
    .then(data => index = data);

  // 2) On every keystroke, filter by substring
  searchInput.addEventListener('input', () => {
    const q = searchInput.value.trim().toLowerCase();
    if (!q) {
      // no query: show full list
      allPostsContainer.classList.remove('hidden');
      resultsContainer.classList.add('hidden');
      paginationContainer.classList.add('hidden');
      return;
    }
    // filter title OR content
    results = index.filter(item =>
      item.title.toLowerCase().includes(q) ||
      item.content.toLowerCase().includes(q)
    );
    currentPage = 0;
    allPostsContainer.classList.add('hidden');
    paginationContainer.classList.remove('hidden');
    renderPage(q);
  });

  // 3) Render a given page of results, highlight matches
  function renderPage(query) {
    resultsContainer.innerHTML = '';
    const start = currentPage * pageSize;
    const pageItems = results.slice(start, start + pageSize);

    if (pageItems.length === 0) {
      resultsContainer.innerHTML = '<li class="text-gray-700">No posts found—try another term.</li>';
    } else {
      pageItems.forEach(post => {
        const li = document.createElement('li');
        li.className = 'mb-6';
        li.innerHTML = `
          <h2 class="text-2xl font-bold text-green-700 mb-1">
            <a href="${post.url}" class="hover:underline">${post.title}</a>
          </h2>
          <p class="text-gray-700 mb-2">${escapeHtml(post.content.slice(0,200))}...</p>
        `;
        resultsContainer.appendChild(li);
      });
      // highlight all occurrences of the query
      new Mark(resultsContainer).mark(query, {
        separateWordSearch: false
      });
    }

    // 4) Build pagination buttons
    paginationContainer.innerHTML = '';
    const totalPages = Math.ceil(results.length / pageSize);

    if (currentPage > 0) {
      const prevBtn = document.createElement('button');
      prevBtn.textContent = 'Previous';
      prevBtn.className = 'px-4 py-2 bg-gray-200 rounded hover:bg-gray-300';
      prevBtn.onclick = () => { currentPage--; renderPage(query); };
      paginationContainer.appendChild(prevBtn);
    }
    if (currentPage < totalPages - 1) {
      const nextBtn = document.createElement('button');
      nextBtn.textContent = 'Next';
      nextBtn.className = 'px-4 py-2 bg-gray-200 rounded hover:bg-gray-300';
      nextBtn.onclick = () => { currentPage++; renderPage(query); };
      paginationContainer.appendChild(nextBtn);
    }

    resultsContainer.classList.remove('hidden');
  }

  // utility to escape HTML
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
});
</script>
